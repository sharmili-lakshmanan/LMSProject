{% extends 'adminpanel/base.html' %}
{% load static %}

{% block title %}Add Student | EduShelf{% endblock title %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'adminpanel/css/add_student.css' %}" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<style>
  .is-invalid {
    border-color: #dc3545 !important;
  }
  .form-actions {
    display: flex;
    justify-content: flex-start;
    gap: 1rem;
  }
</style>
{% endblock extra_head %}

{% block content %}
<main class="main-content">
  <header class="content-header">
    <h1>Add Student</h1>
  </header>

  <div class="form-container">
    <form method="POST" class="student-form" novalidate>
      {% csrf_token %}

      <div class="form-row">
        <div class="form-group">
          <label for="full_name">Full Name</label>
          <input type="text" name="full_name" id="full_name" required class="form-control" placeholder="John Doe">
        </div>
        <div class="form-group">
          <label for="admission_number">Admission Number</label>
          <input type="text" name="admission_number" id="admission_number" required class="form-control" placeholder="ADM2024-001">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" name="email" id="email" required class="form-control" placeholder="example@mail.com">
        </div>
        <div class="form-group">
          <label for="course">Course</label>
          <select name="course" id="course" required class="form-control">
            <option disabled selected>Select Course</option>
            <option value="bsc">B.Sc</option>
            <option value="ba">B.A</option>
            <option value="bcom">B.Com</option>
            <option value="msc">M.Sc</option>
            <option value="ma">M.A</option>
            <option value="mcom">M.Com</option>
          </select>
        </div>
      </div>

      <div class="form-row" id="year-wrapper" style="display: none;">
        <div class="form-group">
          <label for="year">Year</label>
          <select name="year" id="year" required class="form-control">
            <option disabled selected>Select Year</option>
          </select>
        </div>
        <div class="form-group">
          <label for="department">Department</label>
          <input type="text" name="department" id="department" required class="form-control" placeholder="Mathematics">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="admission_year">Admission Year</label>
          <input type="number" name="admission_year" id="admission_year" required class="form-control" placeholder="2023">
        </div>
        <div class="form-group">
          <label for="passout_year">Passout Year</label>
          <input type="number" name="passout_year" id="passout_year" required class="form-control" placeholder="2026">
        </div>
      </div>

      <div class="form-group full-width">
        <label for="phone_number">Phone Number</label>
        <input type="text" name="phone_number" id="phone_number" required class="form-control" placeholder="10-digit number">
      </div>

      <!-- Hidden fields for final course label -->
      <input type="hidden" id="final-course-input" name="final_course">
      <div class="form-group full-width">
        <label>Course Label Preview</label>
        <input type="text" id="course-preview" class="form-control" disabled>
      </div>

      <div class="form-actions mt-3">
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-save"></i> Save Student
        </button>
        <button type="reset" class="btn btn-secondary">
          <i class="fas fa-undo"></i> Reset Form
        </button>
      </div>
    </form>
  </div>

  <!-- Bootstrap Toast for Validation -->
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="formToast" class="toast align-items-center text-white bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body" id="toast-message">Validation message goes here</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>
</main>
{% endblock content %}

{% block extra_js %}
<script src="{% static 'adminpanel/js/add_student.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock extra_js %}
